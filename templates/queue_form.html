{% extends "layout.html" %}
{% block title %}New Queue Observation{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
  <!-- Back Link -->
  <div class="mb-4">
    <a 
      href="{{ url_for('queue_insights_dashboard') }}" 
      class="text-blue-700 hover:text-blue-800 flex items-center text-sm font-medium"
    >
      <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
      </svg>
      Back to Queue Insights
    </a>
  </div>

  <!-- Page Header -->
  <div class="bg-white shadow-lg rounded-lg mb-6 p-6 border border-gray-100">
    <h1 class="text-3xl font-bold text-gray-800 mb-2 flex items-center">
      <svg class="w-8 h-8 mr-3 text-blue-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
      </svg>
      New Queue Observation
    </h1>
    <p class="text-gray-600">
      Log a queue observation to build data for AI-powered insights.
    </p>
  </div>

  <!-- Error Alert -->
  {% if error %}
  <div class="bg-red-100 border border-red-500 text-red-800 px-4 py-3 rounded-md mb-4">
    <div class="flex items-center">
      <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
      </svg>
      <span>{{ error }}</span>
    </div>
  </div>
  {% endif %}

  <!-- Form Card -->
  <div class="bg-white shadow-lg rounded-lg p-6 border border-gray-100">
    <form method="POST" action="{{ url_for('queue_insights_create') }}" class="space-y-5">
      
      <!-- Department -->
      <div>
        <label for="department" class="block text-sm font-medium text-gray-700 mb-1">
          Department <span class="text-red-500">*</span>
        </label>
        <input 
          type="text" 
          id="department" 
          name="department" 
          value="{{ form_data.department if form_data else '' }}"
          placeholder="e.g., Emergency Room, Radiology, Check-in"
          required
          class="block w-full rounded-md border-gray-300 shadow-sm 
                 focus:border-blue-500 focus:ring-blue-500 py-2 px-3 border"
        />
        <p class="mt-1 text-xs text-gray-500">
          Enter the hospital department where the queue was observed
        </p>
      </div>

      <!-- Observed At -->
      <div>
        <label for="observed_at" class="block text-sm font-medium text-gray-700 mb-1">
          Observed At <span class="text-red-500">*</span>
        </label>
        <input 
          type="datetime-local" 
          id="observed_at" 
          name="observed_at" 
          value="{{ form_data.observed_at if form_data else '' }}"
          required
          class="block w-full rounded-md border-gray-300 shadow-sm 
                 focus:border-blue-500 focus:ring-blue-500 py-2 px-3 border"
        />
        <p class="mt-1 text-xs text-gray-500">
          Select the date and time when the observation was made
        </p>
      </div>

      <!-- Number of Patients -->
      <div>
        <label for="number_of_patients" class="block text-sm font-medium text-gray-700 mb-1">
          Number of Patients <span class="text-red-500">*</span>
        </label>
        <input 
          type="number" 
          id="number_of_patients" 
          name="number_of_patients" 
          value="{{ form_data.number_of_patients if form_data else '' }}"
          min="0"
          placeholder="e.g., 12"
          required
          class="block w-full rounded-md border-gray-300 shadow-sm 
                 focus:border-blue-500 focus:ring-blue-500 py-2 px-3 border"
        />
        <p class="mt-1 text-xs text-gray-500">
          Count of patients observed in the queue
        </p>
      </div>

      <!-- Average Wait Minutes -->
      <div>
        <label for="average_wait_minutes" class="block text-sm font-medium text-gray-700 mb-1">
          Average Wait Time (minutes) <span class="text-red-500">*</span>
        </label>
        <input 
          type="number" 
          id="average_wait_minutes" 
          name="average_wait_minutes" 
          value="{{ form_data.average_wait_minutes if form_data else '' }}"
          min="0"
          placeholder="e.g., 45"
          required
          class="block w-full rounded-md border-gray-300 shadow-sm 
                 focus:border-blue-500 focus:ring-blue-500 py-2 px-3 border"
        />
        <p class="mt-1 text-xs text-gray-500">
          Estimated average wait time in minutes
        </p>
      </div>

      <!-- Notes -->
      <div>
        <label for="notes" class="block text-sm font-medium text-gray-700 mb-1">
          Notes (optional)
        </label>
        <textarea 
          id="notes" 
          name="notes" 
          rows="4"
          maxlength="1000"
          placeholder="e.g., Unusually busy for a Tuesday afternoon"
          class="block w-full rounded-md border-gray-300 shadow-sm 
                 focus:border-blue-500 focus:ring-blue-500 py-2 px-3 border"
        >{{ form_data.notes if form_data else '' }}</textarea>
        <p class="mt-1 text-xs text-gray-500">
          Add any additional context or observations (max 1000 characters)
        </p>
      </div>

      <!-- Submit Buttons -->
      <div class="flex gap-4 pt-4">
        <button 
          type="submit" 
          class="bg-blue-700 text-white px-6 py-3 rounded-md hover:bg-blue-800 
                 transition-colors duration-200 font-medium flex items-center shadow-md"
        >
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          Save Observation
        </button>
        
        <a 
          href="{{ url_for('queue_insights_dashboard') }}" 
          class="bg-gray-200 text-gray-700 px-6 py-3 rounded-md hover:bg-gray-300 
                 transition-colors duration-200 font-medium flex items-center"
        >
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
          Cancel
        </a>
      </div>

      <p class="text-xs text-gray-500 pt-2">
        <span class="text-red-500">*</span> Required fields
      </p>
    </form>
  </div>

  <!-- Help Card -->
  <div class="bg-blue-50 border border-blue-200 rounded-lg p-5 mt-6">
    <h3 class="text-sm font-semibold text-blue-900 mb-2 flex items-center">
      <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      Tips for Effective Observations
    </h3>
    <ul class="text-sm text-blue-800 space-y-1 list-disc list-inside">
      <li>Log observations consistently for better trend analysis</li>
      <li>Include specific department names for targeted insights</li>
      <li>Use the notes field to capture contextual information</li>
      <li>Collect data over multiple days for comprehensive analysis</li>
    </ul>
  </div>
</div>

{% endblock %}
